<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>SnapshotUtil</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: org.apache.iceberg.util, class: SnapshotUtil">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.iceberg.util</a></div>
<h1 title="Class SnapshotUtil" class="title">Class SnapshotUtil</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">org.apache.iceberg.util.SnapshotUtil</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">SnapshotUtil</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#ancestorIds(org.apache.iceberg.Snapshot,java.util.function.Function)" class="member-name-link">ancestorIds</a><wbr>(<a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&nbsp;snapshot,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#ancestorIdsBetween(long,java.lang.Long,java.util.function.Function)" class="member-name-link">ancestorIdsBetween</a><wbr>(long&nbsp;latestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;oldestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#ancestorsBetween(long,java.lang.Long,java.util.function.Function)" class="member-name-link">ancestorsBetween</a><wbr>(long&nbsp;latestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;oldestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#ancestorsBetween(org.apache.iceberg.Table,long,java.lang.Long)" class="member-name-link">ancestorsBetween</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;latestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;oldestSnapshotId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#ancestorsOf(long,java.util.function.Function)" class="member-name-link">ancestorsOf</a><wbr>(long&nbsp;snapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#currentAncestorIds(org.apache.iceberg.Table)" class="member-name-link">currentAncestorIds</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Return the snapshot IDs for the ancestors of the current table state.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#currentAncestors(org.apache.iceberg.Table)" class="member-name-link">currentAncestors</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns an iterable that traverses the table's snapshots from the current to the last known
 ancestor.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isAncestorOf(long,long,java.util.function.Function)" class="member-name-link">isAncestorOf</a><wbr>(long&nbsp;snapshotId,
 long&nbsp;ancestorSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns whether ancestorSnapshotId is an ancestor of snapshotId using the given lookup
 function.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isAncestorOf(org.apache.iceberg.Table,long)" class="member-name-link">isAncestorOf</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;ancestorSnapshotId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns whether ancestorSnapshotId is an ancestor of the table's current state.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isAncestorOf(org.apache.iceberg.Table,long,long)" class="member-name-link">isAncestorOf</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;snapshotId,
 long&nbsp;ancestorSnapshotId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns whether ancestorSnapshotId is an ancestor of snapshotId.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isParentAncestorOf(org.apache.iceberg.Table,long,long)" class="member-name-link">isParentAncestorOf</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;snapshotId,
 long&nbsp;ancestorParentSnapshotId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns whether some ancestor of snapshotId has parentId matches ancestorParentSnapshotId</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#latestSnapshot(org.apache.iceberg.TableMetadata,java.lang.String)" class="member-name-link">latestSnapshot</a><wbr>(<a href="../TableMetadata.html" title="class in org.apache.iceberg">TableMetadata</a>&nbsp;metadata,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;branch)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Fetch the snapshot at the head of the given branch in the given table.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#latestSnapshot(org.apache.iceberg.Table,java.lang.String)" class="member-name-link">latestSnapshot</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;branch)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Fetch the snapshot at the head of the given branch in the given table.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../DataFile.html" title="interface in org.apache.iceberg">DataFile</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#newFiles(java.lang.Long,long,java.util.function.Function,org.apache.iceberg.io.FileIO)" class="member-name-link">newFiles</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;baseSnapshotId,
 long&nbsp;latestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup,
 <a href="../io/FileIO.html" title="interface in org.apache.iceberg.io">FileIO</a>&nbsp;io)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#nullableSnapshotIdAsOfTime(org.apache.iceberg.Table,long)" class="member-name-link">nullableSnapshotIdAsOfTime</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;timestampMillis)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#oldestAncestor(org.apache.iceberg.Table)" class="member-name-link">oldestAncestor</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Traverses the history of the table's current snapshot and finds the oldest Snapshot.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#oldestAncestorAfter(org.apache.iceberg.Table,long)" class="member-name-link">oldestAncestorAfter</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;timestampMillis)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Traverses the history of the table's current snapshot, finds the oldest snapshot that was
 committed either at or after a given time.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#oldestAncestorOf(long,java.util.function.Function)" class="member-name-link">oldestAncestorOf</a><wbr>(long&nbsp;snapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Traverses the history and finds the oldest ancestor of the specified snapshot.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#oldestAncestorOf(org.apache.iceberg.Table,long)" class="member-name-link">oldestAncestorOf</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;snapshotId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../Schema.html" title="class in org.apache.iceberg">Schema</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#schemaFor(org.apache.iceberg.TableMetadata,java.lang.String)" class="member-name-link">schemaFor</a><wbr>(<a href="../TableMetadata.html" title="class in org.apache.iceberg">TableMetadata</a>&nbsp;metadata,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;ref)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Return the schema of the snapshot at a given ref.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../Schema.html" title="class in org.apache.iceberg">Schema</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#schemaFor(org.apache.iceberg.Table,long)" class="member-name-link">schemaFor</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;snapshotId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns the schema of the table for the specified snapshot.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../Schema.html" title="class in org.apache.iceberg">Schema</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#schemaFor(org.apache.iceberg.Table,java.lang.Long,java.lang.Long)" class="member-name-link">schemaFor</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;snapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;timestampMillis)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Convenience method for returning the schema of the table for a snapshot, when we have a
 snapshot id or a timestamp.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../Schema.html" title="class in org.apache.iceberg">Schema</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#schemaFor(org.apache.iceberg.Table,java.lang.String)" class="member-name-link">schemaFor</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;ref)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Return the schema of the snapshot at a given ref.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#snapshotAfter(org.apache.iceberg.Table,long)" class="member-name-link">snapshotAfter</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;snapshotId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Traverses the history of the table's current snapshot and finds the snapshot with the given
 snapshot id as its parent.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#snapshotIdAsOfTime(org.apache.iceberg.Table,long)" class="member-name-link">snapshotIdAsOfTime</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;timestampMillis)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns the ID of the most recent snapshot for the table as of the timestamp.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#snapshotIdsBetween(org.apache.iceberg.Table,long,long)" class="member-name-link">snapshotIdsBetween</a><wbr>(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;fromSnapshotId,
 long&nbsp;toSnapshotId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns list of snapshot ids in the range - (fromSnapshotId, toSnapshotId]</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="isAncestorOf(org.apache.iceberg.Table,long,long)">
<h3>isAncestorOf</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isAncestorOf</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;snapshotId,
 long&nbsp;ancestorSnapshotId)</span></div>
<div class="block">Returns whether ancestorSnapshotId is an ancestor of snapshotId.</div>
</section>
</li>
<li>
<section class="detail" id="isAncestorOf(long,long,java.util.function.Function)">
<h3>isAncestorOf</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isAncestorOf</span><wbr><span class="parameters">(long&nbsp;snapshotId,
 long&nbsp;ancestorSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</span></div>
<div class="block">Returns whether ancestorSnapshotId is an ancestor of snapshotId using the given lookup
 function.</div>
</section>
</li>
<li>
<section class="detail" id="isAncestorOf(org.apache.iceberg.Table,long)">
<h3>isAncestorOf</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isAncestorOf</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;ancestorSnapshotId)</span></div>
<div class="block">Returns whether ancestorSnapshotId is an ancestor of the table's current state.</div>
</section>
</li>
<li>
<section class="detail" id="isParentAncestorOf(org.apache.iceberg.Table,long,long)">
<h3>isParentAncestorOf</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isParentAncestorOf</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;snapshotId,
 long&nbsp;ancestorParentSnapshotId)</span></div>
<div class="block">Returns whether some ancestor of snapshotId has parentId matches ancestorParentSnapshotId</div>
</section>
</li>
<li>
<section class="detail" id="currentAncestors(org.apache.iceberg.Table)">
<h3>currentAncestors</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;</span>&nbsp;<span class="element-name">currentAncestors</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table)</span></div>
<div class="block">Returns an iterable that traverses the table's snapshots from the current to the last known
 ancestor.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>table</code> - a Table</dd>
<dt>Returns:</dt>
<dd>an iterable from the table's current snapshot to its last known ancestor</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="currentAncestorIds(org.apache.iceberg.Table)">
<h3>currentAncestorIds</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</span>&nbsp;<span class="element-name">currentAncestorIds</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table)</span></div>
<div class="block">Return the snapshot IDs for the ancestors of the current table state.

 <p>Ancestor IDs are ordered by commit time, descending. The first ID is the current snapshot,
 followed by its parent, and so on.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>table</code> - a <a href="../Table.html" title="interface in org.apache.iceberg"><code>Table</code></a></dd>
<dt>Returns:</dt>
<dd>a set of snapshot IDs of the known ancestor snapshots, including the current ID</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="oldestAncestor(org.apache.iceberg.Table)">
<h3>oldestAncestor</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></span>&nbsp;<span class="element-name">oldestAncestor</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table)</span></div>
<div class="block">Traverses the history of the table's current snapshot and finds the oldest Snapshot.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>null if there is no current snapshot in the table, else the oldest Snapshot.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="oldestAncestorOf(org.apache.iceberg.Table,long)">
<h3>oldestAncestorOf</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></span>&nbsp;<span class="element-name">oldestAncestorOf</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;snapshotId)</span></div>
</section>
</li>
<li>
<section class="detail" id="oldestAncestorOf(long,java.util.function.Function)">
<h3>oldestAncestorOf</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></span>&nbsp;<span class="element-name">oldestAncestorOf</span><wbr><span class="parameters">(long&nbsp;snapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</span></div>
<div class="block">Traverses the history and finds the oldest ancestor of the specified snapshot.

 <p>Oldest ancestor is defined as the ancestor snapshot whose parent is null or has been
 expired. If the specified snapshot has no parent or parent has been expired, the specified
 snapshot itself is returned.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshotId</code> - the ID of the snapshot to find the oldest ancestor</dd>
<dd><code>lookup</code> - lookup function from snapshot ID to snapshot</dd>
<dt>Returns:</dt>
<dd>null if there is no current snapshot in the table, else the oldest Snapshot.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="ancestorsOf(long,java.util.function.Function)">
<h3>ancestorsOf</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;</span>&nbsp;<span class="element-name">ancestorsOf</span><wbr><span class="parameters">(long&nbsp;snapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</span></div>
</section>
</li>
<li>
<section class="detail" id="oldestAncestorAfter(org.apache.iceberg.Table,long)">
<h3>oldestAncestorAfter</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></span>&nbsp;<span class="element-name">oldestAncestorAfter</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;timestampMillis)</span></div>
<div class="block">Traverses the history of the table's current snapshot, finds the oldest snapshot that was
 committed either at or after a given time.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>table</code> - a table</dd>
<dd><code>timestampMillis</code> - a timestamp in milliseconds</dd>
<dt>Returns:</dt>
<dd>the first snapshot after the given timestamp, or null if the current snapshot is older
     than the timestamp</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if the first ancestor after the given time can't be determined</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="snapshotIdsBetween(org.apache.iceberg.Table,long,long)">
<h3>snapshotIdsBetween</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</span>&nbsp;<span class="element-name">snapshotIdsBetween</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;fromSnapshotId,
 long&nbsp;toSnapshotId)</span></div>
<div class="block">Returns list of snapshot ids in the range - (fromSnapshotId, toSnapshotId]

 <p>This method assumes that fromSnapshotId is an ancestor of toSnapshotId.</div>
</section>
</li>
<li>
<section class="detail" id="ancestorIdsBetween(long,java.lang.Long,java.util.function.Function)">
<h3>ancestorIdsBetween</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</span>&nbsp;<span class="element-name">ancestorIdsBetween</span><wbr><span class="parameters">(long&nbsp;latestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;oldestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</span></div>
</section>
</li>
<li>
<section class="detail" id="ancestorsBetween(org.apache.iceberg.Table,long,java.lang.Long)">
<h3>ancestorsBetween</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;</span>&nbsp;<span class="element-name">ancestorsBetween</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;latestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;oldestSnapshotId)</span></div>
</section>
</li>
<li>
<section class="detail" id="ancestorsBetween(long,java.lang.Long,java.util.function.Function)">
<h3>ancestorsBetween</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;</span>&nbsp;<span class="element-name">ancestorsBetween</span><wbr><span class="parameters">(long&nbsp;latestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;oldestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</span></div>
</section>
</li>
<li>
<section class="detail" id="ancestorIds(org.apache.iceberg.Snapshot,java.util.function.Function)">
<h3>ancestorIds</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</span>&nbsp;<span class="element-name">ancestorIds</span><wbr><span class="parameters">(<a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&nbsp;snapshot,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup)</span></div>
</section>
</li>
<li>
<section class="detail" id="newFiles(java.lang.Long,long,java.util.function.Function,org.apache.iceberg.io.FileIO)">
<h3>newFiles</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../DataFile.html" title="interface in org.apache.iceberg">DataFile</a>&gt;</span>&nbsp;<span class="element-name">newFiles</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;baseSnapshotId,
 long&nbsp;latestSnapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>,<wbr><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;&nbsp;lookup,
 <a href="../io/FileIO.html" title="interface in org.apache.iceberg.io">FileIO</a>&nbsp;io)</span></div>
</section>
</li>
<li>
<section class="detail" id="snapshotAfter(org.apache.iceberg.Table,long)">
<h3>snapshotAfter</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></span>&nbsp;<span class="element-name">snapshotAfter</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;snapshotId)</span></div>
<div class="block">Traverses the history of the table's current snapshot and finds the snapshot with the given
 snapshot id as its parent.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the snapshot for which the given snapshot is the parent</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - when the given snapshotId is not found in the table</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - when the given snapshotId is not an ancestor of the current table
     state</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="snapshotIdAsOfTime(org.apache.iceberg.Table,long)">
<h3>snapshotIdAsOfTime</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">snapshotIdAsOfTime</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;timestampMillis)</span></div>
<div class="block">Returns the ID of the most recent snapshot for the table as of the timestamp.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>table</code> - a <a href="../Table.html" title="interface in org.apache.iceberg"><code>Table</code></a></dd>
<dd><code>timestampMillis</code> - the timestamp in millis since the Unix epoch</dd>
<dt>Returns:</dt>
<dd>the snapshot ID</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - when no snapshot is found in the table older than the
     timestamp</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="nullableSnapshotIdAsOfTime(org.apache.iceberg.Table,long)">
<h3>nullableSnapshotIdAsOfTime</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a></span>&nbsp;<span class="element-name">nullableSnapshotIdAsOfTime</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;timestampMillis)</span></div>
</section>
</li>
<li>
<section class="detail" id="schemaFor(org.apache.iceberg.Table,long)">
<h3>schemaFor</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../Schema.html" title="class in org.apache.iceberg">Schema</a></span>&nbsp;<span class="element-name">schemaFor</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 long&nbsp;snapshotId)</span></div>
<div class="block">Returns the schema of the table for the specified snapshot.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>table</code> - a <a href="../Table.html" title="interface in org.apache.iceberg"><code>Table</code></a></dd>
<dd><code>snapshotId</code> - the ID of the snapshot</dd>
<dt>Returns:</dt>
<dd>the schema</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="schemaFor(org.apache.iceberg.Table,java.lang.Long,java.lang.Long)">
<h3>schemaFor</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../Schema.html" title="class in org.apache.iceberg">Schema</a></span>&nbsp;<span class="element-name">schemaFor</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;snapshotId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;timestampMillis)</span></div>
<div class="block">Convenience method for returning the schema of the table for a snapshot, when we have a
 snapshot id or a timestamp. Only one of them should be specified (non-null), or an
 IllegalArgumentException is thrown.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>table</code> - a <a href="../Table.html" title="interface in org.apache.iceberg"><code>Table</code></a></dd>
<dd><code>snapshotId</code> - the ID of the snapshot</dd>
<dd><code>timestampMillis</code> - the timestamp in millis since the Unix epoch</dd>
<dt>Returns:</dt>
<dd>the schema</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if both snapshotId and timestampMillis are non-null</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="schemaFor(org.apache.iceberg.Table,java.lang.String)">
<h3>schemaFor</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../Schema.html" title="class in org.apache.iceberg">Schema</a></span>&nbsp;<span class="element-name">schemaFor</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;ref)</span></div>
<div class="block">Return the schema of the snapshot at a given ref.

 <p>If the ref does not exist or the ref is a branch, the table schema is returned because it
 will be the schema when the new branch is created. If the ref is a tag, then the snapshot
 schema is returned.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>table</code> - a <a href="../Table.html" title="interface in org.apache.iceberg"><code>Table</code></a></dd>
<dd><code>ref</code> - ref name of the table (nullable)</dd>
<dt>Returns:</dt>
<dd>schema of the specific snapshot at the given ref</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="schemaFor(org.apache.iceberg.TableMetadata,java.lang.String)">
<h3>schemaFor</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../Schema.html" title="class in org.apache.iceberg">Schema</a></span>&nbsp;<span class="element-name">schemaFor</span><wbr><span class="parameters">(<a href="../TableMetadata.html" title="class in org.apache.iceberg">TableMetadata</a>&nbsp;metadata,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;ref)</span></div>
<div class="block">Return the schema of the snapshot at a given ref.

 <p>If the ref does not exist or the ref is a branch, the table schema is returned because it
 will be the schema when the new branch is created. If the ref is a tag, then the snapshot
 schema is returned.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>metadata</code> - a <a href="../TableMetadata.html" title="class in org.apache.iceberg"><code>TableMetadata</code></a></dd>
<dd><code>ref</code> - ref name of the table (nullable)</dd>
<dt>Returns:</dt>
<dd>schema of the specific snapshot at the given branch</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="latestSnapshot(org.apache.iceberg.Table,java.lang.String)">
<h3>latestSnapshot</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></span>&nbsp;<span class="element-name">latestSnapshot</span><wbr><span class="parameters">(<a href="../Table.html" title="interface in org.apache.iceberg">Table</a>&nbsp;table,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;branch)</span></div>
<div class="block">Fetch the snapshot at the head of the given branch in the given table.

 <p>This method calls <a href="../Table.html#currentSnapshot()"><code>Table.currentSnapshot()</code></a> instead of using branch API <a href="../Table.html#snapshot(java.lang.String)"><code>Table.snapshot(String)</code></a> for the main branch so that existing code still goes through the old
 code path to ensure backwards compatibility.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>table</code> - a <a href="../Table.html" title="interface in org.apache.iceberg"><code>Table</code></a></dd>
<dd><code>branch</code> - branch name of the table (nullable)</dd>
<dt>Returns:</dt>
<dd>the latest snapshot for the given branch</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="latestSnapshot(org.apache.iceberg.TableMetadata,java.lang.String)">
<h3>latestSnapshot</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a></span>&nbsp;<span class="element-name">latestSnapshot</span><wbr><span class="parameters">(<a href="../TableMetadata.html" title="class in org.apache.iceberg">TableMetadata</a>&nbsp;metadata,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;branch)</span></div>
<div class="block">Fetch the snapshot at the head of the given branch in the given table.

 <p>This method calls <a href="../TableMetadata.html#currentSnapshot()"><code>TableMetadata.currentSnapshot()</code></a> instead of using branch API <a href="../TableMetadata.html#ref(java.lang.String)"><code>TableMetadata.ref(String)</code></a>} for the main branch so that existing code still goes through the
 old code path to ensure backwards compatibility.

 <p>If branch does not exist, the table's latest snapshot is returned it will be the schema when
 the new branch is created.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>metadata</code> - a <a href="../TableMetadata.html" title="class in org.apache.iceberg"><code>TableMetadata</code></a></dd>
<dd><code>branch</code> - branch name of the table metadata (nullable)</dd>
<dt>Returns:</dt>
<dd>the latest snapshot for the given branch</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
