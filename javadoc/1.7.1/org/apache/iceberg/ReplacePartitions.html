<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) -->
<title>ReplacePartitions</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: org.apache.iceberg, interface: ReplacePartitions">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.iceberg</a></div>
<h1 title="Interface ReplacePartitions" class="title">Interface ReplacePartitions</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code><a href="PendingUpdate.html" title="interface in org.apache.iceberg">PendingUpdate</a>&lt;<a href="Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;</code>, <code><a href="SnapshotUpdate.html" title="interface in org.apache.iceberg">SnapshotUpdate</a>&lt;<a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a>&gt;</code></dd>
</dl>
<dl class="notes">
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="BaseReplacePartitions.html" title="class in org.apache.iceberg">BaseReplacePartitions</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">ReplacePartitions</span><span class="extends-implements">
extends <a href="SnapshotUpdate.html" title="interface in org.apache.iceberg">SnapshotUpdate</a>&lt;<a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a>&gt;</span></div>
<div class="block">API for overwriting files in a table by partition.

 <p>This is provided to implement SQL compatible with Hive table operations but is not
 recommended. Instead, use the <a href="OverwriteFiles.html" title="interface in org.apache.iceberg"><code>overwrite API</code></a> to explicitly overwrite data.

 <p>The default validation mode is idempotent, meaning the overwrite is correct and should be
 committed out regardless of other concurrent changes to the table. Alternatively, this API can be
 configured to validate that no new data or deletes have been applied since a snapshot ID
 associated when this operation began. This can be done by calling <a href="#validateNoConflictingDeletes()"><code>validateNoConflictingDeletes()</code></a>, <a href="#validateNoConflictingData()"><code>validateNoConflictingData()</code></a>, to ensure that no
 conflicting delete files or data files respectively have been written since the snapshot passed
 to <a href="#validateFromSnapshot(long)"><code>validateFromSnapshot(long)</code></a>.

 <p>This API accumulates file additions and produces a new <a href="Snapshot.html" title="interface in org.apache.iceberg"><code>Snapshot</code></a> of the table by
 replacing all files in partitions with new data with the new additions. This operation is used to
 implement dynamic partition replacement.

 <p>When committing, these changes will be applied to the latest table snapshot. Commit conflicts
 will be resolved by applying the changes to the new latest snapshot and reattempting the commit.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#addFile(org.apache.iceberg.DataFile)" class="member-name-link">addFile</a><wbr>(<a href="DataFile.html" title="interface in org.apache.iceberg">DataFile</a>&nbsp;file)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Add a <a href="DataFile.html" title="interface in org.apache.iceberg"><code>DataFile</code></a> to the table.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#validateAppendOnly()" class="member-name-link">validateAppendOnly</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Validate that no partitions will be replaced and the operation is append-only.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#validateFromSnapshot(long)" class="member-name-link">validateFromSnapshot</a><wbr>(long&nbsp;snapshotId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Set the snapshot ID used in validations for this operation.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#validateNoConflictingData()" class="member-name-link">validateNoConflictingData</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Enables validation that data added concurrently does not conflict with this commit's operation.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#validateNoConflictingDeletes()" class="member-name-link">validateNoConflictingDeletes</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Enables validation that deletes that happened concurrently do not conflict with this commit's
 operation.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.iceberg.PendingUpdate">Methods inherited from interface&nbsp;org.apache.iceberg.<a href="PendingUpdate.html" title="interface in org.apache.iceberg">PendingUpdate</a></h3>
<code><a href="PendingUpdate.html#apply()">apply</a>, <a href="PendingUpdate.html#commit()">commit</a>, <a href="PendingUpdate.html#updateEvent()">updateEvent</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.iceberg.SnapshotUpdate">Methods inherited from interface&nbsp;org.apache.iceberg.<a href="SnapshotUpdate.html" title="interface in org.apache.iceberg">SnapshotUpdate</a></h3>
<code><a href="SnapshotUpdate.html#deleteWith(java.util.function.Consumer)">deleteWith</a>, <a href="SnapshotUpdate.html#scanManifestsWith(java.util.concurrent.ExecutorService)">scanManifestsWith</a>, <a href="SnapshotUpdate.html#set(java.lang.String,java.lang.String)">set</a>, <a href="SnapshotUpdate.html#stageOnly()">stageOnly</a>, <a href="SnapshotUpdate.html#toBranch(java.lang.String)">toBranch</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="addFile(org.apache.iceberg.DataFile)">
<h3>addFile</h3>
<div class="member-signature"><span class="return-type"><a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a></span>&nbsp;<span class="element-name">addFile</span><wbr><span class="parameters">(<a href="DataFile.html" title="interface in org.apache.iceberg">DataFile</a>&nbsp;file)</span></div>
<div class="block">Add a <a href="DataFile.html" title="interface in org.apache.iceberg"><code>DataFile</code></a> to the table.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>file</code> - a data file</dd>
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="validateAppendOnly()">
<h3>validateAppendOnly</h3>
<div class="member-signature"><span class="return-type"><a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a></span>&nbsp;<span class="element-name">validateAppendOnly</span>()</div>
<div class="block">Validate that no partitions will be replaced and the operation is append-only.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="validateFromSnapshot(long)">
<h3>validateFromSnapshot</h3>
<div class="member-signature"><span class="return-type"><a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a></span>&nbsp;<span class="element-name">validateFromSnapshot</span><wbr><span class="parameters">(long&nbsp;snapshotId)</span></div>
<div class="block">Set the snapshot ID used in validations for this operation.

 <p>All validations will check changes after this snapshot ID. If this is not called, validation
 will occur from the beginning of the table's history.

 <p>This method should be called before this operation is committed. If a concurrent operation
 committed a data or delta file or removed a data file after the given snapshot ID that might
 contain rows matching a partition marked for deletion, validation will detect this and fail.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshotId</code> - a snapshot ID, it should be set to when this operation started to read the
     table.</dd>
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="validateNoConflictingDeletes()">
<h3>validateNoConflictingDeletes</h3>
<div class="member-signature"><span class="return-type"><a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a></span>&nbsp;<span class="element-name">validateNoConflictingDeletes</span>()</div>
<div class="block">Enables validation that deletes that happened concurrently do not conflict with this commit's
 operation.

 <p>Validating concurrent deletes is required during non-idempotent replace partition
 operations. This will check if a concurrent operation deletes data in any of the partitions
 being overwritten, as the replace partition must be aborted to avoid undeleting rows that were
 removed concurrently.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="validateNoConflictingData()">
<h3>validateNoConflictingData</h3>
<div class="member-signature"><span class="return-type"><a href="ReplacePartitions.html" title="interface in org.apache.iceberg">ReplacePartitions</a></span>&nbsp;<span class="element-name">validateNoConflictingData</span>()</div>
<div class="block">Enables validation that data added concurrently does not conflict with this commit's operation.

 <p>Validating concurrent data files is required during non-idempotent replace partition
 operations. This will check if a concurrent operation inserts data in any of the partitions
 being overwritten, as the replace partition must be aborted to avoid removing rows added
 concurrently.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
