<!DOCTYPE HTML>
<html lang="fr">
<head>
<!-- Generated by javadoc (17) -->
<title>OverwriteFiles</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: org.apache.iceberg, interface: OverwriteFiles">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.iceberg</a></div>
<h1 title="Interface OverwriteFiles" class="title">Interface OverwriteFiles</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code><a href="PendingUpdate.html" title="interface in org.apache.iceberg">PendingUpdate</a>&lt;<a href="Snapshot.html" title="interface in org.apache.iceberg">Snapshot</a>&gt;</code>, <code><a href="SnapshotUpdate.html" title="interface in org.apache.iceberg">SnapshotUpdate</a>&lt;<a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a>&gt;</code></dd>
</dl>
<dl class="notes">
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="BaseOverwriteFiles.html" title="class in org.apache.iceberg">BaseOverwriteFiles</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">OverwriteFiles</span><span class="extends-implements">
extends <a href="SnapshotUpdate.html" title="interface in org.apache.iceberg">SnapshotUpdate</a>&lt;<a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a>&gt;</span></div>
<div class="block">API for overwriting files in a table.

 <p>This API accumulates file additions and produces a new <a href="Snapshot.html" title="interface in org.apache.iceberg"><code>Snapshot</code></a> of the table by
 replacing all the deleted files with the set of additions. This operation is used to implement
 idempotent writes that always replace a section of a table with new data or update/delete
 operations that eagerly overwrite files.

 <p>Overwrites can be validated. The default validation mode is idempotent, meaning the overwrite
 is correct and should be committed out regardless of other concurrent changes to the table. For
 example, this can be used for replacing all the data for day D with query results. Alternatively,
 this API can be configured for overwriting certain files with their filtered versions while
 ensuring no new data that would need to be filtered has been added.

 <p>When committing, these changes will be applied to the latest table snapshot. Commit conflicts
 will be resolved by applying the changes to the new latest snapshot and reattempting the commit.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#addFile(org.apache.iceberg.DataFile)" class="member-name-link">addFile</a><wbr>(<a href="DataFile.html" title="interface in org.apache.iceberg">DataFile</a>&nbsp;file)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Add a <a href="DataFile.html" title="interface in org.apache.iceberg"><code>DataFile</code></a> to the table.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#caseSensitive(boolean)" class="member-name-link">caseSensitive</a><wbr>(boolean&nbsp;caseSensitive)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Enables or disables case sensitive expression binding for validations that accept expressions.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#conflictDetectionFilter(org.apache.iceberg.expressions.Expression)" class="member-name-link">conflictDetectionFilter</a><wbr>(<a href="expressions/Expression.html" title="interface in org.apache.iceberg.expressions">Expression</a>&nbsp;conflictDetectionFilter)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Sets a conflict detection filter used to validate concurrently added data and delete files.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#deleteFile(org.apache.iceberg.DataFile)" class="member-name-link">deleteFile</a><wbr>(<a href="DataFile.html" title="interface in org.apache.iceberg">DataFile</a>&nbsp;file)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Delete a <a href="DataFile.html" title="interface in org.apache.iceberg"><code>DataFile</code></a> from the table.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#overwriteByRowFilter(org.apache.iceberg.expressions.Expression)" class="member-name-link">overwriteByRowFilter</a><wbr>(<a href="expressions/Expression.html" title="interface in org.apache.iceberg.expressions">Expression</a>&nbsp;expr)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Delete files that match an <a href="expressions/Expression.html" title="interface in org.apache.iceberg.expressions"><code>Expression</code></a> on data rows from the table.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#validateAddedFilesMatchOverwriteFilter()" class="member-name-link">validateAddedFilesMatchOverwriteFilter</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Signal that each file added to the table must match the overwrite expression.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#validateFromSnapshot(long)" class="member-name-link">validateFromSnapshot</a><wbr>(long&nbsp;snapshotId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Set the snapshot ID used in any reads for this operation.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#validateNoConflictingData()" class="member-name-link">validateNoConflictingData</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Enables validation that data added concurrently does not conflict with this commit's operation.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#validateNoConflictingDeletes()" class="member-name-link">validateNoConflictingDeletes</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Enables validation that deletes that happened concurrently do not conflict with this commit's
 operation.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.iceberg.PendingUpdate">Methods inherited from interface&nbsp;org.apache.iceberg.<a href="PendingUpdate.html" title="interface in org.apache.iceberg">PendingUpdate</a></h3>
<code><a href="PendingUpdate.html#apply()">apply</a>, <a href="PendingUpdate.html#commit()">commit</a>, <a href="PendingUpdate.html#updateEvent()">updateEvent</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.iceberg.SnapshotUpdate">Methods inherited from interface&nbsp;org.apache.iceberg.<a href="SnapshotUpdate.html" title="interface in org.apache.iceberg">SnapshotUpdate</a></h3>
<code><a href="SnapshotUpdate.html#deleteWith(java.util.function.Consumer)">deleteWith</a>, <a href="SnapshotUpdate.html#scanManifestsWith(java.util.concurrent.ExecutorService)">scanManifestsWith</a>, <a href="SnapshotUpdate.html#set(java.lang.String,java.lang.String)">set</a>, <a href="SnapshotUpdate.html#stageOnly()">stageOnly</a>, <a href="SnapshotUpdate.html#toBranch(java.lang.String)">toBranch</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="overwriteByRowFilter(org.apache.iceberg.expressions.Expression)">
<h3>overwriteByRowFilter</h3>
<div class="member-signature"><span class="return-type"><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></span>&nbsp;<span class="element-name">overwriteByRowFilter</span><wbr><span class="parameters">(<a href="expressions/Expression.html" title="interface in org.apache.iceberg.expressions">Expression</a>&nbsp;expr)</span></div>
<div class="block">Delete files that match an <a href="expressions/Expression.html" title="interface in org.apache.iceberg.expressions"><code>Expression</code></a> on data rows from the table.

 <p>A file is selected to be deleted by the expression if it could contain any rows that match
 the expression (candidate files are selected using an <a href="expressions/Projections.html#inclusive(org.apache.iceberg.PartitionSpec)"><code>inclusive projection</code></a>). These candidate files are deleted
 if all of the rows in the file must match the expression (the partition data matches the
 expression's <a href="expressions/Projections.html#strict(org.apache.iceberg.PartitionSpec)"><code>Projections.strict(PartitionSpec)</code></a> strict projection}). This guarantees
 that files are deleted if and only if all rows in the file must match the expression.

 <p>Files that may contain some rows that match the expression and some rows that do not will
 result in a <a href="exceptions/ValidationException.html" title="class in org.apache.iceberg.exceptions"><code>ValidationException</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>expr</code> - an expression on rows in the table</dd>
<dt>Returns:</dt>
<dd>this for method chaining</dd>
<dt>Throws:</dt>
<dd><code><a href="exceptions/ValidationException.html" title="class in org.apache.iceberg.exceptions">ValidationException</a></code> - If a file can contain both rows that match and rows that do not</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="addFile(org.apache.iceberg.DataFile)">
<h3>addFile</h3>
<div class="member-signature"><span class="return-type"><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></span>&nbsp;<span class="element-name">addFile</span><wbr><span class="parameters">(<a href="DataFile.html" title="interface in org.apache.iceberg">DataFile</a>&nbsp;file)</span></div>
<div class="block">Add a <a href="DataFile.html" title="interface in org.apache.iceberg"><code>DataFile</code></a> to the table.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>file</code> - a data file</dd>
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="deleteFile(org.apache.iceberg.DataFile)">
<h3>deleteFile</h3>
<div class="member-signature"><span class="return-type"><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></span>&nbsp;<span class="element-name">deleteFile</span><wbr><span class="parameters">(<a href="DataFile.html" title="interface in org.apache.iceberg">DataFile</a>&nbsp;file)</span></div>
<div class="block">Delete a <a href="DataFile.html" title="interface in org.apache.iceberg"><code>DataFile</code></a> from the table.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>file</code> - a data file</dd>
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="validateAddedFilesMatchOverwriteFilter()">
<h3>validateAddedFilesMatchOverwriteFilter</h3>
<div class="member-signature"><span class="return-type"><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></span>&nbsp;<span class="element-name">validateAddedFilesMatchOverwriteFilter</span>()</div>
<div class="block">Signal that each file added to the table must match the overwrite expression.

 <p>If this method is called, each added file is validated on commit to ensure that it matches
 the overwrite row filter. This is used to ensure that writes are idempotent: that files cannot
 be added during a commit that would not be removed if the operation were run a second time.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="validateFromSnapshot(long)">
<h3>validateFromSnapshot</h3>
<div class="member-signature"><span class="return-type"><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></span>&nbsp;<span class="element-name">validateFromSnapshot</span><wbr><span class="parameters">(long&nbsp;snapshotId)</span></div>
<div class="block">Set the snapshot ID used in any reads for this operation.

 <p>Validations will check changes after this snapshot ID. If the from snapshot is not set, all
 ancestor snapshots through the table's initial snapshot are validated.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshotId</code> - a snapshot ID</dd>
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="caseSensitive(boolean)">
<h3>caseSensitive</h3>
<div class="member-signature"><span class="return-type"><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></span>&nbsp;<span class="element-name">caseSensitive</span><wbr><span class="parameters">(boolean&nbsp;caseSensitive)</span></div>
<div class="block">Enables or disables case sensitive expression binding for validations that accept expressions.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>caseSensitive</code> - whether expression binding should be case sensitive</dd>
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="conflictDetectionFilter(org.apache.iceberg.expressions.Expression)">
<h3>conflictDetectionFilter</h3>
<div class="member-signature"><span class="return-type"><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></span>&nbsp;<span class="element-name">conflictDetectionFilter</span><wbr><span class="parameters">(<a href="expressions/Expression.html" title="interface in org.apache.iceberg.expressions">Expression</a>&nbsp;conflictDetectionFilter)</span></div>
<div class="block">Sets a conflict detection filter used to validate concurrently added data and delete files.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conflictDetectionFilter</code> - an expression on rows in the table</dd>
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="validateNoConflictingData()">
<h3>validateNoConflictingData</h3>
<div class="member-signature"><span class="return-type"><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></span>&nbsp;<span class="element-name">validateNoConflictingData</span>()</div>
<div class="block">Enables validation that data added concurrently does not conflict with this commit's operation.

 <p>This method should be called while committing non-idempotent overwrite operations. If a
 concurrent operation commits a new file after the data was read and that file might contain
 rows matching the specified conflict detection filter, the overwrite operation will detect this
 and fail.

 <p>Calling this method with a correct conflict detection filter is required to maintain
 isolation for non-idempotent overwrite operations.

 <p>Validation uses the conflict detection filter passed to <a href="#conflictDetectionFilter(org.apache.iceberg.expressions.Expression)"><code>conflictDetectionFilter(Expression)</code></a> and applies to operations that happened after the
 snapshot passed to <a href="#validateFromSnapshot(long)"><code>validateFromSnapshot(long)</code></a>. If the conflict detection filter is not
 set, any new data added concurrently will fail this overwrite operation.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="validateNoConflictingDeletes()">
<h3>validateNoConflictingDeletes</h3>
<div class="member-signature"><span class="return-type"><a href="OverwriteFiles.html" title="interface in org.apache.iceberg">OverwriteFiles</a></span>&nbsp;<span class="element-name">validateNoConflictingDeletes</span>()</div>
<div class="block">Enables validation that deletes that happened concurrently do not conflict with this commit's
 operation.

 <p>Validating concurrent deletes is required during non-idempotent overwrite operations. If a
 concurrent operation deletes data in one of the files being overwritten, the overwrite
 operation must be aborted as it may undelete rows that were removed concurrently.

 <p>Calling this method with a correct conflict detection filter is required to maintain
 isolation for non-idempotent overwrite operations.

 <p>Validation uses the conflict detection filter passed to <a href="#conflictDetectionFilter(org.apache.iceberg.expressions.Expression)"><code>conflictDetectionFilter(Expression)</code></a> and applies to operations that happened after the
 snapshot passed to <a href="#validateFromSnapshot(long)"><code>validateFromSnapshot(long)</code></a>. If the conflict detection filter is not
 set, this operation will use the row filter provided in <a href="#overwriteByRowFilter(org.apache.iceberg.expressions.Expression)"><code>overwriteByRowFilter(Expression)</code></a> to check for new delete files and will ensure there are no
 conflicting deletes for data files removed via <a href="#deleteFile(org.apache.iceberg.DataFile)"><code>deleteFile(DataFile)</code></a>.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>this for method chaining</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
